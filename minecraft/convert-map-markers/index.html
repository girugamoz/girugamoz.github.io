<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.js" integrity="sha512-CwxrLIN0dww6lRc/oKeZiI9oGlOob2HPMU0Yu0g+P3/G1cuTii+tt0jpyEKhilfrV7D/zmvKiVPIHUDU6xbBxg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js" integrity="sha512-8RnEqURPUc5aqFEN04aQEiPlSAdE0jlFS/9iGgUyNtwFnSKCXhmB6ZTNl7LnDtDWKabJIASzXrzD0K+LYexU9g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/yaml/yaml.min.js" integrity="sha512-+aXDZ93WyextRiAZpsRuJyiAZ38ztttUyO/H3FZx4gOAOv4/k9C6Um1CvHVtaowHZ2h7kH0d+orWvdBLPVwb4g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js" integrity="sha512-I6CdJdruzGtvDyvdO4YsiAq+pkWf2efgd1ZUSK2FnM/u2VuRASPC7GowWQrWyjxCZn6CT89s3ddGI+be0Ak9Fg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css" integrity="sha512-uf06llspW44/LZpHzHT6qBOIVODjWtv4MxCricRxkzvopAlSWnTf6hpZTFxuuZcuNE9CBQhqE0Seu1CoRk84nQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

        <script async defer
            src="https://umami.bavariancripple.de/umami.js"
            data-website-id="4e154ab2-ea24-4094-b59f-0afc8e07c5d7"
            data-domains="girugamoz.github.io"
        ></script>

        <script src="./convert.js"></script>
        <link rel="stylesheet" href="./style.css">

        <title>Marker Converter</title>
        <meta name="description" content="Convert Minecraft map marker definitions from DynMap to BlueMap"/>
    </head>
    <body>
        <div class="main">
            <div class="about">
                <h1>Convert Minecraft map marker definitions</h1>
                <h2>from DynMap to BlueMap</h2>
                Marker documentation: <a href="https://github.com/webbukkit/dynmap/wiki/Using-markers">DynMap</a>,
                <a href="https://bluemap.bluecolored.de/wiki/customization/Markers.html">BlueMap</a>
            </div>
            <div class="input">
                <h3>Input</h3>
                <label for="input">Contents of DynMap <span class="highlight-text">markers.yml</span>: </label>
                <textarea name="input" class="source">
%YAML 1.1
---
icons:
    mobs.zombiepigman:
        label: Zombie Pigman
    mobs.cat:
        label: Cat
    structures.temple:
        label: Temple
    my.special.icon:
        label: My special icon
sets:
    myset:
        hide: true
        circles: {
            }
        deficon: default
        areas:
            aspawnchunks:
                fillColor: 16711680
                world: world
                markup: false
                ytop: 65.0
                fillOpacity: 0.35
                x:
                - -1329.0
                - -1609.0
                - -1609.0
                - -1329.0
                strokeWeight: 3
                z:
                - -46.0
                - -46.0
                - 234.0
                - 234.0
                label: Spawn Chunks (+/- 16)
                ybottom: 61.0
                strokeColor: 16711680
                strokeOpacity: 0.8
            awitchfarm:
                fillColor: 15894886
                world: world
                markup: false
                ytop: 65.0
                fillOpacity: 0.3
                x:
                - -833.0
                - -533.0
                strokeWeight: 3
                z:
                - 510.0
                - 810.0
                label: Witch Farm
                ybottom: 65.0
                strokeColor: 0
                strokeOpacity: 0.5
        label: MySet
        markers:
            marker_34:
                world: world
                markup: false
                x: -1027.0
                icon: zkn.rail.platform
                y: 37.0
                z: 734.0
                label: Bunker
            marker_32:
                world: world
                markup: false
                x: -674.0
                icon: vehicles.explosive-minecart
                y: 68.0
                z: 2875.0
                label: Cooked Mutton
            marker_2:
                world: world
                markup: false
                x: 641.0
                icon: world
                y: 65.0
                z: -3407.0
                label: Cow farm
            village,15634656,-29244400:
                world: world
                markup: false
                x: 1.5634656E7
                icon: structures.village
                y: 64.0
                z: -2.92444E7
                label: Village
            marker_19:
                world: world_nether
                markup: false
                x: -1014.0
                icon: default
                y: 91.0
                z: 4052096.0
                label: Mt. Mutton
        lines:
            line_1:
                world: world
                markup: false
                x:
                - 69.0
                - 69.0
                - 67.0
                - 67.0
                - 63.0
                - 63.0
                - 65.0
                - 65.0
                - -35.0
                strokeWeight: 3
                y:
                - 120.0
                - 120.0
                - 120.0
                - 120.0
                - 120.0
                - 121.0
                - 121.0
                - 121.0
                - 121.0
                z:
                - 618.0
                - 621.0
                - 621.0
                - 617.0
                - 617.0
                - 738.0
                - 738.0
                - 1875.0
                - 1875.0
                label: line_1
                strokeColor: 16711680
                strokeOpacity: 0.8
        layerprio: 0
        </textarea>
                <div class="actions">
                    <input type="button" id="convert-button" value="Convert"
                        class="umami--click--convert-button">
                </div>
            </div>

            <div class="options">
                <h3>Options</h3>

                <div class="row">
                    <label for="world">World name: </label>
                    <div class="select-editable">
                        <select onchange="this.nextElementSibling.value=this.value">
                            <option value=""></option>
                            <option value="world">world</option>
                            <option value="world_nether">world_nether</option>
                            <option value="world_the_end">world_the_end</option>
                        </select>
                        <input name="world" type="text" class="world" value="world">
                    </div>
                    <div class="descr">DynMap <span class="highlight-text">markers.yml</span> contains markers from all worlds, choose one.</div>
                </div>

                <div class="row">
                    <label for="world">Excluded sets: </label>
                    <textarea name="excluded-sets" class="excluded-sets">
offline_players
spawn_beds
</textarea>
                    <div class="descr">One set name per line.</div>
                </div>

                <div class="row">
                    <label for="world">Marker icon mapping: </label>
                    <input name="world" type="text" class="icon-mapping" value="assets/markers/%icon%.png">
                    <div class="descr">The placeholder <span class="highlight-text">%icon%</span> is replaced with the icon name.</div>
                </div>

                <div class="row">
                    <label for="world">Icon anchor mapping: </label>
                    <textarea name="iconanchors" class="icon-anchors">
{
    "*": { "x": 8, "y": 8 },
    "vehicles.boat": {"x": 4, "y": 3},
    "vehicles.explosive-minecart": {"x": 4, "y": 3.5},
    "vehicles.hopper-minecart": {"x": 4, "y": 3.5},
    "vehicles.minecart": {"x": 4, "y": 3.5},
    "vehicles.powered-minecart": {"x": 4, "y": 3.5},
    "vehicles.spawner-minecart": {"x": 4, "y": 3.5},
    "vehicles.storage-minecart": {"x": 4, "y": 3.5},
    "zkn.rail.platform": {"x": 16, "y": 16}
}
</textarea>
                    <div class="descr">BlueMap <a href="https://bluemap.bluecolored.de/wiki/customization/Markers.html#poi-markers">POI markers</a> support an optional icon offset, called
                        <span class="highlight-text">anchor</span>. This configuration option uses JSON syntax to map DynMap icon names to BlueMap anchors. Fractions will be rounded to the nearest integer.
                        Optionally you can use the icon name <span class="highlight-text">*</span> to specify a default anchor for all POI marker icons.
                        <br>
                        Imagemagick's <a href="https://imagemagick.org/script/identify.php">identify</a> tool can calculate the center of your icons, e.g. (don't forget to remove the last trailing comma if you use this command):
                        <pre>identify -format '"%t": {"x": %[fx:w/2], "y": %[fx:h/2]},\n' *.png</pre>
                    </div>
                </div>

                <div class="row">
                    <label for="append-marker-name-to-label">Append marker name to label: </label>
                    <input name="append-marker-name-to-label" type="checkbox" class="append-marker-name-to-label">
                    <div class="descr">Useful for debugging and editing markers.</div>
                </div>
            </div>

            <div class="output">
                <h3>Output</h3>
                <label for="output">BlueMap <span class="highlight-text">marker-sets</span> entry, paste this into <span class="highlight-text">world.conf</span>: </label>
                <textarea name="output" class="source"></textarea>
            </div>

            <div class="output">
                <h3>About</h3>
                <div class="descr">Problems or suggestions? Open a <a href="https://github.com/girugamoz/girugamoz.github.io/issues/new/choose">github issue</a>.</div>
                <div class="descr">Source: <a href="https://github.com/girugamoz/girugamoz.github.io/tree/main/minecraft/convert-map-markers">GitHub</a></div>
            </div>
        </div>
    </body>
</html>
